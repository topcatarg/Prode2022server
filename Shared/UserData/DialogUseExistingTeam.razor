@using System.Collections.Immutable
@using Prode2022Server.Models.UserData
@using Prode2022Server.Helpers

<MudDialog>
    <DialogContent>
        <MudSelect 
            @bind-Value="SelectedTeam"
            T="int" 
            Label="Equipos" 
            Variant="Variant.Outlined" 
            AnchorOrigin="Origin.BottomCenter">
            @foreach(var T in TeamList)
            {
                <MudSelectItem T="int" Value="T.UserTeamId">@T.TeamName</MudSelectItem>
            }
        </MudSelect>
        @if (!TournamentPassword.IsNullOrEmpty())
        {
            <MudTextField @bind-Value="Password" Label="Password" Variant="Variant.Text" />
            @if(TournamentPassword != Password)
            {
                <MudText>Password incorrecto</MudText>
            }
        }
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel" >Cancelar</MudButton>
        <MudButton 
            Color="Color.Primary" 
            OnClick="Submit"
            Disabled="TournamentPassword!=Password">Ok</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; } = default!;
    [Parameter] public int SelectedTeam {get;set;} = 0;
    [Parameter] public ImmutableArray<UserTournament> TeamList {get;set;} = new();
    [Parameter] public string TournamentPassword { get; set; } = "";
    private string Password { get; set; } = "";

    void Submit() 
    {
        MudDialog.Close(DialogResult.Ok(SelectedTeam));
    } 
    void Cancel() => MudDialog.Cancel();
}